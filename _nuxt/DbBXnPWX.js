import{n as e,bw as a,ax as l,gi as t,D as s,F as r,au as i,M as n,fi as o,c as d,o as c,b as m,a as f,w as p,J as u,t as b,E as x,d as g,a8 as h,K as v,cO as y,dj as w,aN as N,aa as F,aq as _,H as P,aK as j,S as M,qp as O}from"./Ck65DhTU.js";import{E as D,a as C}from"./DnulTJLV.js";import"./BwAGr_Cw.js";import"./CPubcWut.js";import"./BZz6c_uP.js";const S=["infinite-scroll-disabled"],T={class:"text-12px"},Y={key:1},k={class:"text-14px"},V={class:"flex items-center justify-end gap-4px"},z={class:"color-[--main-text] font-bold mb-8px"},I={class:"flex items-center justify-between text-12px mb-16px"},L={class:"color-[--third-text]"},H={class:"flex items-center justify-between text-12px mb-16px"},U={class:"color-[--third-text]"},q={class:"flex items-center justify-between text-12px mb-16px"},B={class:"color-[--third-text]"},E={class:"flex items-center justify-between text-12px mb-16px"},K={class:"color-[--third-text]"},A={class:"flex flex-col text-12px mb-16px gap-4px"},J={class:"color-[--third-text]"},Q={class:"flex flex-col text-12px"},$={class:"color-[--third-text]"},G={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},R={key:0},W=e({__name:"closePnl",props:{searchParams:{}},setup(e){const W=a(),{t:X}=l(),Z=e,ee=t(),ae=i([]),le=r({loading:!1,finished:!1,error:!1}),te=r(""),se=x(()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=ee.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return t.ALL=X("all"),t}),re=e=>h(e.realizePnl-e.deltaOpenFee),ie=async()=>{if(le.value.loading||le.value.finished)return;const e={filterCloseOnly:!0,...Z.searchParams};te.value&&(e.offsetData=te.value);try{le.value.loading=!0;const a=await O(e);let l=a.dataList||[];te.value&&(l=ae.value.concat(l)),a.nextPageOffsetData||(le.value.finished=!0),te.value=a.nextPageOffsetData,ae.value=l}catch(a){le.value.error=!0}finally{le.value.loading=!1}};return W.address&&ie(),s(()=>[Z.searchParams,W.address],()=>{te.value="",ae.value=[],le.value.finished=!1,le.value.error=!1,le.value.loading=!1,ie()}),(e,a)=>{const l=j,t=D,s=F,r=N,i=C,x=o;return n((c(),d("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":u(le).loading||u(le).finished||u(le).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[m(i,{fit:"",data:u(ae),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:p(()=>{var a;return[u(le).loading||0!==(null==(a=u(ae))?void 0:a.length)?(c(),d("span",Y)):(c(),P(l,{key:0,class:"pt-[40px]"},{default:p(()=>[f("span",T,b(e.$t("emptyNoData")),1)]),_:1}))]}),default:p(()=>[m(t,{label:u(X)("markets1"),prop:"contractId"},{default:p(({row:e})=>[f("span",k,b(u(se)[e.contractId]),1)]),_:1},8,["label"]),m(t,{width:120,label:u(X)("Qty")},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(a.beforeOpenSize))+" "+b(u(se)[a.contractId].replace("USD","")),1)]),_:1},8,["label"]),m(t,{width:150,align:"right",label:u(X)("entryPrice")},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(a.beforeOpenValue/a.beforeOpenSize,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(t,{width:150,align:"right",label:u(X)("exitPrice")},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(a.fillPrice,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(t,{"min-width":80,align:"right",label:u(X)("tradeType"),prop:"side"},{default:p(({row:e})=>[f("span",{class:v(e.type.includes("BUY")?"color-[--up-color]":"color-[--down-color]")},b(e.type.includes("BUY")?u(X)("buy"):u(X)("sell")),3)]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("closePnl"),prop:"closePnl"},{default:p(({row:a})=>[f("div",V,[f("span",{class:v(("getColorClass"in e?e.getColorClass:u(y))(re(a)))},b(("addSign"in e?e.addSign:u(w))(+re(a)))+b(Math.abs(+re(a))),3),m(r,{width:200},{reference:p(()=>[m(s,{name:"custom:info"})]),default:p(()=>[f("div",null,[f("div",z,b(u(X)("closePnlDetail")),1),f("div",I,[f("span",L,b(u(X)("closeValue")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.fillCloseValue),{limit:20})),1)]),f("div",H,[f("span",U,b(u(X)("openValue")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.beforeOpenValue),{limit:20})),1)]),f("div",q,[f("span",B,b(u(X)("fee")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.fillCloseFee)+Math.abs(a.beforeOpenFee),{limit:20})),1)]),f("div",E,[f("span",K,b(u(X)("fundingFee")),1),f("span",null,b(("formatNumber"in e?e.formatNumber:u(h))(a.deltaFundingFee,{limit:20})),1)]),f("div",A,[f("span",J,b(u(X)("long2")),1),f("span",null,b(u(X)("longPnl")),1)]),f("div",Q,[f("span",$,b(u(X)("short2")),1),f("span",null,b(u(X)("shortPnl")),1)])])]),_:2},1024)])]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("openFee"),prop:"openFee"},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.beforeOpenFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("closeFee"),prop:"closeFee"},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.fillCloseFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("fundingFee"),prop:"fundingFee"},{default:p(({row:a})=>[g(b(("formatNumber"in e?e.formatNumber:u(h))(Math.abs(a.deltaFundingFee),{limit:20})),1)]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("exitType"),prop:"exitType"},{default:p(()=>[g(b(u(X)("trades")),1)]),_:1},8,["label"]),m(t,{align:"right",label:u(X)("tradeTime"),prop:"fundingTime"},{default:p(({row:e})=>[g(b(u(_)(+e.censorTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"])]),_:1},8,["data"]),f("div",G,[u(le).loading&&u(te)?(c(),d("span",R,b(u(X)("loading")),1)):M("",!0)])],8,S)),[[x,ie]])}}});export{W as default};
