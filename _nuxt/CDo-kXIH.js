import{n as e,ax as a,a3 as l,a2 as t,bs as n,cD as s,bC as o,D as i,F as r,E as c,aT as u,ce as d,au as p,aO as m,a7 as v,c as x,o as f,a as b,b as h,S as y,H as g,t as k,J as w,w as T,aa as C,al as j,T as I,d as $,a5 as B,a6 as _,M as D,K as A,aM as M,cB as N,gh as S,d6 as U,bZ as W,fN as z,fO as R}from"./Ck65DhTU.js";import V from"./lC0DB2i2.js";import Z from"./D_ZTmfHj.js";import H from"./B2K95ReY.js";import{_ as O,a as E,b as F}from"./BEisXu1r.js";import"./DnulTJLV.js";import"./CPubcWut.js";import"./BwAGr_Cw.js";import"./BZz6c_uP.js";import"./Brh3DTBm.js";const J={class:"bg-[--secondary-bg] flex-1 w-100% px-200px pt-40px overflow-y-auto bot-manage",style:{height:"calc(100vh - 150px)"}},K={class:"mb-8px flex-between items-center"},L={class:"text-16px font-500"},P={key:0},q={class:"flex-between"},G={class:"text-24px"},Q={key:0,class:"mask text-center color-[--main-text] absolute bg-[--border] top-0 right-0 left-0 bottom-0 flex items-center justify-center z-1 text-14px cursor-pointer"},X={class:"grid grid-cols-3 gap-2 mt-30px"},Y={class:"color-[--third-text] rounded-4px text-10px px-4px py-1px overflow-hidden text-ellipsis whitespace-nowrap max-w-100px line-height-15px absolute left-2px top-2px"},ee={class:"text-center mt-30px flex-between"},ae=e({__name:"index",setup(e,{expose:ae}){ae({getMultiWalletsAllChain:$e});const{t:le}=a(),{showImport:te,mode:ne,showBotRecord:se}=l(t()),{getUserInfo:oe}=n(),{theme:ie,isDark:re}=l(s()),ce=n(),ue=p(!1),de=p(!1),pe=p(!0),me=o("encryptedMnemonic","",sessionStorage),ve=p(!1),xe=r([]),fe=r([]),be=p(!1),he=p(!1),ye=r(0),ge=r(!1);let ke=null;const we=c(()=>{var e;const a=me.value||"",l=(null==(e=null==ce?void 0:ce.userInfo)?void 0:e.tgUid)||"";if(a&&l){return S(a,l).split(" ")||[]}return[]}),Te=c(()=>(null==ce?void 0:ce.evmAddress)||"");function Ce(){ge.value||($e(),je(10))}i(()=>Te.value,e=>{e?$e():(xe.value=[],fe.value=[])}),u(()=>{$e(),ke&&clearInterval(ke)}),d(()=>{ke&&(clearInterval(ke),ke=null)});const je=e=>{ye.value=e,ge.value=!0,ke=U(()=>{ye.value--,ye.value<=0&&(clearInterval(ke),ke=null,ge.value=!1)},1e3)};function Ie(){be.value=!0,E().then(e=>{const a=Array.isArray(e)?null==e?void 0:e.map(e=>({...e,updateTime:"1970-01-01T00:00:00Z"!==(null==e?void 0:e.updateTime)&&"0001-01-01T00:00:00Z"!==(null==e?void 0:e.updateTime)?new Date(e.updateTime).getTime():0})):[];null==a||a.sort((e,a)=>Number(null==a?void 0:a.updateTime)-Number(null==e?void 0:e.updateTime)),fe.value=a,se.value=!0}).catch(e=>{m.error(e)}).finally(()=>{be.value=!1})}function $e(){return new Promise((e,a)=>{ve.value=!0;const l=ce.isSupportChains;O(null==l?void 0:l.join(",")).then(a=>{xe.value=Array.isArray(a)?null==a?void 0:a.map((e,a)=>{var l,t,n,s,o,i,r,c;return{id:`parent-${a}`,tgUid:e.tgUid,address:e.tgUid,name:e.name,source:e.source,operate:"delete",genSource:e.genSource,evmAddress:(null==(n=null==(t=null==(l=e.balancesInfo)?void 0:l.filter(e=>"bsc"==e.chain))?void 0:t[0])?void 0:n.address)||"",balance:null==(s=null==e?void 0:e.balancesInfo)?void 0:s.reduce((e,a)=>e+Number(a.balance),0),mainTokenBalance:null==(o=null==e?void 0:e.balancesInfo)?void 0:o.reduce((e,a)=>e+Number(a.mainTokenBalance),0),usdcTokenBalance:null==(i=null==e?void 0:e.balancesInfo)?void 0:i.reduce((e,a)=>e+Number(a.usdcTokenBalance),0),usdtTokenBalance:null==(r=null==e?void 0:e.balancesInfo)?void 0:r.reduce((e,a)=>e+Number(a.usdtTokenBalance),0),balancesInfo:null==(c=e.balancesInfo)?void 0:c.map((e,l)=>({...e,id:`child-${a}-${l}`,name:e.address,operate:"deposit",isChildren:!0}))}}):[],e(xe.value)}).catch(e=>{m.error(e),a([])}).finally(()=>{ve.value=!1,he.value=!1})})}function Be(){W.confirm(le("createWalletTip"),le("createWallet"),{type:"warning",icon:z(R),confirmButtonText:le("confirm"),cancelButtonText:le("cancel"),customClass:`${ne.value} delete_confirm`}).then(()=>{ue.value=!0,F().then(e=>{me.value=null==e?void 0:e.Mnemonic,pe.value=!0,de.value=!0,_e(),oe()}).catch(e=>{m.error(String(e))}).finally(()=>{ue.value=!1})}).catch(e=>{})}function _e(){$e()}const De=()=>{W.confirm(le("lastChance"),le("tips"),{type:"warning",icon:z(R),confirmButtonText:le("saved"),cancelButtonText:le("cancel"),customClass:`${ne.value} delete_confirm`}).then(()=>{me.value="",de.value=!1}).catch(e=>{})};return(e,a)=>{const l=C,t=I,n=N,s=v("copy");return f(),x("div",J,[b("div",K,[b("span",L,k(e.$t("walletList")),1),w(Te)?(f(),x("span",{key:0,class:"text-16px font-500 color-[--third-text] ml-40px cursor-pointer",onClick:Ie},k(e.$t("operateHistory")),1)):y("",!0),a[5]||(a[5]=b("div",{class:"flex-1"},null,-1)),w(Te)?(f(),g(t,{key:1,class:"text-12px",size:"small",onClick:j(Ce,["stop","prevent"]),disabled:w(ge)},{default:T(()=>[w(ye)>0?(f(),x("span",P,k(w(ye))+"S",1)):(f(),g(l,{key:1,name:"material-symbols:sync-outline",class:"text-12px"}))]),_:1},8,["disabled"])):y("",!0),w(Te)?(f(),g(t,{key:2,class:"text-12px",size:"small",type:"primary",onClick:j(Be,["stop","prevent"]),loading:w(ue)},{default:T(()=>[h(l,{name:"custom:wallet-fill",class:"text-12px mr-4px"}),$(k(e.$t("createWallet")),1)]),_:1},8,["loading"])):y("",!0),w(Te)?(f(),g(t,{key:3,class:"text-12px",size:"small",onClick:a[0]||(a[0]=j(e=>te.value=!0,["stop","prevent"]))},{default:T(()=>[h(l,{name:"mingcute:new-folder-fill",class:"text-102x mr-4px"}),$(k(e.$t("importWallet")),1)]),_:1})):y("",!0)]),h(V,{tableData:w(xe),loading:w(ve),onRefresh:_e},null,8,["tableData","loading"]),h(Z,{onRefresh:_e}),h(H,{tableData:w(fe),loading:w(be)},null,8,["tableData","loading"]),h(n,{modelValue:w(de),"onUpdate:modelValue":a[4]||(a[4]=e=>M(de)?de.value=e:null),width:"500",height:"630",class:A(["dialog-connect1",w(ie)]),"append-to-body":"","close-on-click-modal":!1,"show-close":!1,"destroy-on-close":""},{header:T(()=>[b("div",q,[b("span",G,k(e.$t("mnemonic")),1),h(l,{name:"material-symbols-light:close",class:"text-30px cursor-pointer",onClick:a[1]||(a[1]=j(e=>de.value=!1,["stop","prevent"]))})])]),default:T(()=>{var n;return[b("div",{class:"relative min-h-160px",onClick:a[2]||(a[2]=e=>pe.value=!1)},[w(pe)?(f(),x("div",Q,[h(l,{name:"custom:show-code",class:"text-16px mr-4px color-[--main-text]"}),$(" "+k(e.$t("clickMnemonic")),1)])):y("",!0),b("div",X,[(f(!0),x(B,null,_(w(we),(e,a)=>(f(),x("div",{class:"mnemonic-item block border border-solid border-[--dialog-divider] py-8px text-center relative",key:a},[b("span",Y,k(a+1),1),$(" "+k(e),1)]))),128))])]),b("div",ee,[D((f(),g(t,{class:"flex-1",style:{height:"48px"},onClick:a[3]||(a[3]=j(()=>{},["stop","prevent"]))},{default:T(()=>[$(k(e.$t("copyMnemonic")),1)]),_:1})),[[s,null==(n=w(we))?void 0:n.join(" ")]]),h(t,{class:"flex-1",style:{height:"48px"},type:"primary",onClick:j(De,["stop","prevent"])},{default:T(()=>[$(k(e.$t("continue")),1)]),_:1})])]}),_:1},8,["modelValue","class"])])}}});export{ae as default};
