import{f as e,B as l,ad as a,s as t,C as s,b5 as o,b6 as n,aa as i,c as u,o as r,F as d,b as c,i as v,J as m,L as p,a0 as b,K as g,j as y,w as f,b7 as w,d as x,k,t as h,b4 as B,I as _,l as V,a as F,at as T,O as S,ai as A,Y as N,b8 as q,b9 as I,ba as L,bb as $,bc as C,bd as E,be as M,x as O,bf as R}from"./B65fceU8.js";const U={key:0,class:"ml-5px"},j={class:"text-20px"},z={class:"min-h-60px py-10px"},P={class:"text-16px"},W={class:"flex mt-10px"},D=e({__name:"quickSwapButton",props:{quickBuyValue:{},row:{},appendTo:{default:"#__nuxt"},buttonBg:{default:"rgba(18, 184, 134, 0.15)"},mainNameVisible:{type:Boolean},classNames:{default:""},styles:{default:""}},emits:["submitSwap"],setup(e,{emit:D}){const{t:G}=l(),J=e,K=a(),Q=t(!1),Y=t(!1),H=t(""),X=s("noReminderQuickBuy",!1),Z=D;function ee(e){var l;if(e.stopPropagation(),Z("submitSwap"),!A(!0))return;if(Q.value)return;if(new N(J.quickBuyValue||0).lte(0))return void q({title:"Error",type:"error",message:G("amountMustG0")});const{row:a}=J;H.value=G("quickBuyMsg",{a:J.quickBuyValue,m:(null==(l=B(J.row.chain))?void 0:l.main_name)||"",s:a.symbol||(a.target_token==a.token0_address?a.token0_symbol:a.token1_symbol)}),X.value?te():Y.value=!0}const le=t(),ae=o();async function te(){var e;Y.value=!1;const{chain:l}=J.row;Q.value=!0,await async function(e){var l;const a=K.getWalletAddress(e);if(!a)return;const t=await R({chain:e,tokens:[$(e)],walletAddress:a}),s=(null==t?void 0:t[0])||{};le.value={...s,symbol:null==(l=B(e))?void 0:l.main_name,chain:e,address:s.token||s.address,decimals:s.decimals||s.decimal}}(l);const a=le.value,t=null==(e=new N(J.quickBuyValue||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${(null==a?void 0:a.decimals)||18}})?`)))?void 0:e[0];return(Number(t)||0)<=0?(q({title:"Error",type:"error",message:G("amountTooSmall")}),void(Q.value=!1)):new N(t||0).gt((null==a?void 0:a.balance)||0)?(q({title:"Error",type:"error",message:G("insufficientBalance")}),void(Q.value=!1)):void async function(e){var l,a,t;const{chain:s}=J.row,o="solana"===s,{botSettings:n}=ae,i=null==(l=null==n?void 0:n[s])?void 0:l.selected,u=null==(a=null==n?void 0:n[s])?void 0:a[i];if(o&&(null==u?void 0:u.mev)&&!(await K.getBundleAvailable()))return void(Q.value=!1);const{gasTip1List:r,gasTip2List:d}=I(L().gasTip,"solana"),c=(null==u?void 0:u.mev)?r:d,v=(null==u?void 0:u.mev)?null==u?void 0:u.gas[0]:null==(t=null==u?void 0:u.gas)?void 0:t[1];let m={};if(o){let e=(null==v?void 0:v.customFee)||(null==c?void 0:c[null==v?void 0:v.level])||"0.002";(null==u?void 0:u.mev)&&new N(e).lt("0.002")&&(e="0.002"),m.priorityFee=new N(e).times(10**9).toFixed(0)}else{const e=0===Number(null==v?void 0:v.customFee)?"0":(null==v?void 0:v.customFee)||(null==c?void 0:c[null==v?void 0:v.level])||"3";m.gasTip=Number(new N(e).times(10**9).toFixed(0)),m.contractType=0,m.chain=s}const p=$(s),b=(null==u?void 0:u.slippage)||"9",g=K.getWalletAddress(s);if(!g)return;m={...m,batchId:Date.now().toString(),swapList:[{creatorAddress:g,inAmount:new N(e||0).times(10**le.value.decimals||0).toFixed(0)}],inTokenAddress:p,outTokenAddress:J.row.token||J.row.target_token,swapType:1,isPrivate:(null==u?void 0:u.mev)||!1,slippage:"auto"!==b?Number(new N(b).times(100).toFixed(0)):900,autoSell:(null==u?void 0:u.autoSell)||!1};(o?C(m):E(m)).then(e=>function(e,l){if(e){let e=setTimeout(()=>{q({type:"success",message:G("transactionsSubmitted")}),se.placeOrderUpdate++,Q.value=!1},500);const a=O(()=>oe.wsResult.tgbot,t=>{var s,o,n,i;t.batchId===l&&(e&&(clearTimeout(e),e=null),se.placeOrderSuccess++,(null==(o=null==(s=null==t?void 0:t.txList)?void 0:s[0])?void 0:o.success)?(q({type:"success",message:G("tradeSuccess")}),a()):(M((null==(i=null==(n=null==t?void 0:t.txList)?void 0:n[0])?void 0:i.failMessage)||"swap error"),a()),Q.value=!1)})}}(e,m.batchId)).catch(e=>{M(e||"swap error"),Q.value=!1})}(t)}const se=n(),oe=i();return(e,l)=>{const a=k,t=p,s=T,o=_;return r(),u(d,null,[c(t,{disabled:!Number(e.quickBuyValue),loading:y(Q),color:e.buttonBg,class:g(["flex items-center [&&]:px-12px",e.classNames]),style:b([{"--el-button-hover-bg-color":"#12B886","--el-button-hover-text-color":"#FFF","--el-color-black":"#12B886","--el-button-border-color":"transparent","--el-button-hover-border-color":"transparent","--el-button-disabled-text-color":"#12B886","--el-button-disabled-border-color":"transparent","--el-button-disabled-bg-color":"#12B8861A"},e.styles]),onClick:ee},{default:f(()=>[w(e.$slots,"default",{},()=>{var l;return[c(a,{class:"mr-4px",name:"mynaui:lightning-solid"}),x(" "+h(e.quickBuyValue||0)+" ",1),e.mainNameVisible?(r(),u("span",U,h((null==(l=("getChainInfo"in e?e.getChainInfo:y(B))(e.row.chain))?void 0:l.main_name)||""),1)):m("",!0)]})]),_:3},8,["disabled","loading","color","class","style"]),y(Y)?(r(),v(o,{key:0,modelValue:y(Y),"onUpdate:modelValue":l[1]||(l[1]=e=>V(Y)?Y.value=e:null),title:e.$t("buy"),width:"400px","append-to":e.appendTo},{header:f(()=>[F("span",j,h(e.$t("buy")),1)]),footer:f(()=>[c(t,{type:"primary",class:"w-full",size:"large",onClick:S(te,["stop"])},{default:f(()=>[x(h(e.$t("confirm1")),1)]),_:1})]),default:f(()=>[F("div",z,[F("div",P,h(y(H)),1),F("div",W,[c(s,{modelValue:y(X),"onUpdate:modelValue":l[0]||(l[0]=e=>V(X)?X.value=e:null),class:"[&&]:[--el-checkbox-text-color:--d-999-l-666]",label:e.$t("noAlert"),size:"large"},null,8,["modelValue","label"])])])]),_:1},8,["modelValue","title","append-to"])):m("",!0)],64)}}});export{D as _};
