import{_ as a}from"./DTCUnfOn.js";import{E as e}from"./BDzN6Gig.js";import{n as t,ax as i,a2 as s,a3 as r,bC as o,E as n,D as c,F as l,aT as p,az as u,bN as m,aA as v,au as d,bs as _,bw as h,aq as g,ca as y,cb as b,c as k,o as j,M as f,H as w,S as x,bP as C,J as T,L as I,bp as S,a6 as z,w as N,a4 as O,a5 as A,cQ as E,b as $,_ as F}from"./Ck65DhTU.js";import"./BwAGr_Cw.js";import"./Cjh5n7V4.js";import"./CPubcWut.js";import{H as q,s as L,d as P,f as V,I as B,h as H,i as R,j as D,k as M,l as U,m as G,n as J,o as Q,t as X,v as Y,w as Z,x as K,y as W,z as aa,A as ea,B as ta,D as ia,C as sa,E as ra,F as oa,P as na,G as ca}from"./C6xjxmbg.js";import{g as la}from"./BXpozOC3.js";import"./BF1S9I1X.js";import"./CsJaFgS0.js";import"./CNCF1BOl.js";import"./tmD3CgVF.js";import"./DsxdcEHf.js";import"./BbIkpTl9.js";import"./VcOrqKoc.js";import"./Bbfgb7E8.js";import"./B4zcb_8g.js";import"./3zf6s2PU.js";import"./BZz6c_uP.js";import"./BtHoUnZy.js";import"./C5ONRGoJ.js";import"./D-tFlNOh.js";import"./CO5_ekb3.js";import"./CSZyNKXU.js";import"./DfznddBS.js";import"./CfgshW7J.js";import"./BqG8h9m0.js";import"./D1Joxpzi.js";const pa=F(t({__name:"activity",props:{listMapFunction:{type:Function},activeChain:{},activeSubTab:{},activeTab:{},height:{},ammList:{}},setup(t){const{t:F}=i(),pa=s(),ua=t,{rankConditions:ma}=r(pa);function va(a){ma.value[ua.activeTab].sort=a,ga.value.pageNO=1,wa()}function da(...a){a.forEach(a=>{L(ma.value[ua.activeTab].filter,a[0],a[1])}),ga.value.pageNO=1,wa()}const _a=l([]),ha=n(()=>pa.pumpSetting.isBlacklist?_a.value.filter(a=>{return e=a,!(-1!==pa.pumpBlackList.findIndex(a=>a.address==e.token&&"ca"==a.type||a.address==e.symbol&&"keyword"==a.type));var e}):_a.value);const ga=l({pageNO:1,pageSize:50,total:0}),ya=d(!1),ba=n(()=>ua.activeTab+"Ranks");let ka,ja=o(ba.value,q(F));function fa({rowData:a}){E(`/token/${a.target_token}-${a.chain}`)}async function wa(a=!0){var e,t;try{a&&(ya.value=!0);const{total:i,...s}=ga.value,r=_().evmAddress||h().address||"",o=["created_at_max","created_at_min"].reduce((a,e)=>(a[e]&&(a[e]=g().unix()-60*Number(a[e])),a),{...null==(e=ma.value[ua.activeTab])?void 0:e.filter}),n=await la({category:ua.activeTab,...s,chain:"AllChains"!==ua.activeChain?ua.activeChain:"",...null==(t=ma.value[ua.activeTab])?void 0:t.sort,...o,self_address:r});ga.value.total=n.total,_a.value=(n.data||[]).map(ua.listMapFunction),a&&function(){xa.send({jsonrpc:"2.0",method:"unsubscribe",params:["price_extra"],id:1});const a=_a.value.map(a=>`${a.pair}-${a.chain}`);xa.send({jsonrpc:"2.0",method:"subscribe",params:["price_extra",a],id:1})}(),clearTimeout(ka),ka=window.setTimeout(()=>{wa(!1)},1e4)}finally{ya.value=!1}}c(()=>ua.activeTab,()=>{Na(),ja=o(ba.value,q(F)),ga.value.pageNO=1,wa()},{immediate:!0}),p(()=>{wa()}),u(()=>{clearTimeout(ka)}),m(()=>{Na(),clearTimeout(ka),ka=window.setTimeout(()=>{wa(!1)},1e4)}),v(()=>{clearTimeout(ka)}),c(()=>[ua.activeChain,ua.activeTab],()=>{ga.value.pageNO=1,wa()});const xa=y();function Ca(){ga.value.pageNO=1,wa()}c(()=>xa.wsResult[b.PRICE_EXTRA],({prices:a})=>{var e;const t=Array.isArray(a)?a.reduce((a,e)=>(a[e.pair+"-"+e.chain]=e,a),{}):{},i=_a.value.map(a=>{const e=t[a.pair+"-"+a.chain];if(e){delete e.holders,delete e.last_trade_at;const t=a.current_price_usd?(a.market_cap||0)/a.current_price_usd*(e.uprice||0):0;return{...a,market_cap:t,current_price_usd:e.uprice,...e}}return a}),{sort:s,sort_dir:r}=null==(e=ma.value[ua.activeTab])?void 0:e.sort,o={asc:"1",desc:"-1"}[r];o&&(_a.value=i.toSorted((a,e)=>(a[s]-e[s])*o))}),h(),_();const Ta={price_change_dynamic:a=>a.isVisible&&!["1m","24h"].includes(pa.rankCommon.activeInterval),quick:a=>a.isVisible&&pa.rankCommon.quickVisible},Ia=n(()=>ba.value?ja.value.filter(a=>Ta[a.key]?Ta[a.key](a):a.isVisible):ja.value),Sa=n(()=>({poolPair:Q,headline:()=>F("aiSummary"),mCap:J,price_change_1m:G,price_change_24h:G,price_change_dynamic:G,tvl:U,dynamicVolAndTxs:M,markers_dynamic:D,holders:R,smart_money_buy_volume_24h:H,dex:B,security:()=>F("security"),holders_top10_ratio:V,quick:()=>F("quick"),sniper_tx_count:P})),za=n(()=>({poolPair:na,headline:oa,mCap:ra,price_change_1m:({row:a})=>$(ca,{row:a,activeInterval:"1m"},null),price_change_24h:({row:a})=>$(ca,{row:a,activeInterval:"24h"},null),price_change_dynamic:({row:a})=>$(ca,{row:a,activeInterval:pa.rankCommon.activeInterval},null),tvl:sa,dynamicVolAndTxs:ia,markers_dynamic:ta,holders:ea,smart_money_buy_volume_24h:aa,dex:W,security:K,holders_top10_ratio:Z,quick:Y,sniper_tx_count:X}));function Na(){ma.value[ua.activeTab]||(ma.value[ua.activeTab]={sort:{sort:"",sort_dir:""},filter:{}})}return(i,s)=>{const r=a,o=e,n=C;return j(),k(A,null,[f((j(),k("div",{style:I(`height:${t.height}`)},[(j(),w(r,{key:t.activeTab,"row-key":"pair_id",loading:T(ya),data:T(ha),columns:T(Ia),"header-height":40,"row-height":81,fixed:"",style:{"--el-bg-color":"var(--secondary-bg)"},"row-class":"cursor-pointer [&&]:[--el-table-border:1px_solid_var(--main-divider)]",rowEventHandlers:{onClick:fa}},S({_:2},[z(T(Ia),a=>({name:`header-${a.key}`,fn:N(()=>{var e;return[(j(),w(O(T(Sa)[a.key]),{sortConditions:null==(e=T(ma)[t.activeTab])?void 0:e.sort,setSortConditions:va,setFilterForm:da,activeInterval:a.activeInterval||T(pa).rankCommon.activeInterval,ammList:"dex"===a.key?t.ammList:null},null,8,["sortConditions","activeInterval","ammList"]))]})})),z(T(Ia),a=>({name:`cell-${a.key}`,fn:N(({row:e,rowIndex:i})=>[(j(),w(O(T(za)[a.key]),{class:"text-14px",row:e,rowIndex:i,pageNO:T(ga).pageNO,pageSize:T(ga).pageSize,activeInterval:a.activeInterval||T(pa).rankCommon.activeInterval,activeChain:t.activeChain},null,8,["row","rowIndex","pageNO","pageSize","activeInterval","activeChain"]))])}))]),1032,["loading","data","columns","rowEventHandlers"]))],4)),[[n,T(ya)]]),T(ga).total?(j(),w(o,{key:0,"current-page":T(ga).pageNO,"onUpdate:currentPage":s[0]||(s[0]=a=>T(ga).pageNO=a),"page-size":T(ga).pageSize,"onUpdate:pageSize":s[1]||(s[1]=a=>T(ga).pageSize=a),class:"mt-5px py-9px flex justify-center [&&]:[--el-pagination-button-height:18px]",layout:"total, prev, pager, next",total:T(ga).total||0,small:!1,"page-sizes":[20,50,100,200,300,400],onSizeChange:Ca,onCurrentChange:s[2]||(s[2]=()=>wa())},null,8,["current-page","page-size","total"])):x("",!0)],64)}}}),[["__scopeId","data-v-ec3f2318"]]);export{pa as default};
