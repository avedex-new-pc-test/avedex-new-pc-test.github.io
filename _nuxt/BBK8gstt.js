import{a as e,E as a}from"./Cjh5n7V4.js";import{E as l}from"./Dth2FjKW.js";import{n as t,gi as i,ax as r,F as n,aq as o,c as s,o as d,a as u,M as c,b as m,w as f,a5 as p,a6 as v,J as b,E as g,H as x,t as h,d as T,fi as E,K as w,a8 as y,qr as C,au as N,aK as S,S as I,qp as L}from"./Ck65DhTU.js";import{E as _,a as j}from"./DnulTJLV.js";import"./BwAGr_Cw.js";import"./CPubcWut.js";import{S as D}from"./CfgshW7J.js";import"./BtHoUnZy.js";import"./B6IuEvha.js";import"./BbIkpTl9.js";import"./BZz6c_uP.js";const z={class:"flex items-center justify-end gap-8px mb-16px"},Y={class:"flex items-center gap-4px text-12px"},P=["infinite-scroll-disabled"],V={class:"text-12px"},k={key:1},F={class:"mt-[2px] mb-[5px] py-[10px] text-[12px] text-center color-[--third-text]"},M={key:0},O=t({__name:"fundingRate",setup(t){const O=i(),{t:U}=r(),A=N([]),R=n({loading:!1,finished:!1,error:!1}),q=n(""),H=n({filterTypeList:"SETTLE_FUNDING_FEE",filterContractIdList:"ALL",filterStartCreatedTimeInclusive:o().subtract(7,"d").startOf("day").unix(),filterEndCreatedTimeExclusive:o().endOf("day").unix()}),K=g(()=>{var e,a,l;const t=(null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.reduce)?void 0:l.call(a,(e,a)=>(e[a.contractId]=a.contractName,e),{}))||{};return t.ALL=U("all"),t}),X=g(()=>{var e,a,l;const t=null==(l=null==(a=null==(e=O.metadata)?void 0:e.contractList)?void 0:a.map)?void 0:l.call(a,e=>({label:e.contractName,value:e.contractId}));return[{label:U("all"),value:"ALL"}].concat(t||[])}),$=e=>!!H.value.filterEndCreatedTimeExclusive&&o(e).isAfter(o(1e3*Number(H.value.filterEndCreatedTimeExclusive))),B=e=>!!H.value.filterStartCreatedTimeInclusive&&o(e).isBefore(o(1e3*Number(H.value.filterStartCreatedTimeInclusive))),G=async()=>{if(R.value.loading||R.value.finished)return;const e=Object.create(null);Object.keys(H.value).forEach(a=>{const l=H.value[a];l&&(["filterStartCreatedTimeInclusive","filterEndCreatedTimeExclusive"].includes(a)?e[a]=1e3*l:"ALL"!==l&&(e[a]=l))}),q.value&&(e.offsetData=q.value);try{R.value.loading=!0;const a=await L(e);let l=a.dataList||[];q.value&&(l=A.value.concat(l)),a.nextPageOffsetData||(R.value.finished=!0),q.value=a.nextPageOffsetData,A.value=l}catch(a){R.value.error=!0}finally{R.value.loading=!1}};G();const J=()=>{q.value="",A.value=[],R.value.finished=!1,R.value.error=!1,R.value.loading=!1,G()};return(t,i)=>{const r=e,n=a,g=l,N=S,L=_,O=j,Q=E;return d(),s(p,null,[u("div",z,[m(n,{modelValue:b(H).filterContractIdList,"onUpdate:modelValue":i[0]||(i[0]=e=>b(H).filterContractIdList=e),size:"small",class:"[&&]:[--el-select-width:110px]","popper-class":"[--el-font-size-base:12px]","suffix-icon":b(D),persistent:!1,onChange:J},{prefix:f(()=>[u("span",null,h(b(U)("markets1")),1)]),default:f(()=>[(d(!0),s(p,null,v(b(X),e=>(d(),x(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","suffix-icon"]),u("div",Y,[m(g,{modelValue:b(H).filterStartCreatedTimeInclusive,"onUpdate:modelValue":i[1]||(i[1]=e=>b(H).filterStartCreatedTimeInclusive=e),size:"small","disabled-date":$,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("startTime"),"value-format":"X",teleported:!1,clearable:!1,onChange:J},null,8,["modelValue","placeholder"]),T(" "+h(t.$t("to"))+" ",1),m(g,{modelValue:b(H).filterEndCreatedTimeExclusive,"onUpdate:modelValue":i[2]||(i[2]=e=>b(H).filterEndCreatedTimeExclusive=e),size:"small","disabled-date":B,class:"[--el-font-size-base:12px] [&&]:[--el-date-editor-width:120px]","range-separator":"To",format:"YYYY-MM-DD",placeholder:b(U)("endTime1"),"value-format":"X",teleported:!1,clearable:!1,onChange:J},null,8,["modelValue","placeholder"])])]),c((d(),s("div",{class:"relative min-h-400px bg-[--secondary-bg]","infinite-scroll-delay":200,"infinite-scroll-disabled":b(R).loading||b(R).finished||b(R).error,"infinite-scroll-immediate":!1,"infinite-scroll-distance":300},[m(O,{data:b(A),"header-row-class-name":"text-12px sticky top-0 z-10 font-500","cell-class-name":"color-[--main-text] text-12px"},{empty:f(()=>{var e;return[b(R).loading||0!==(null==(e=b(A))?void 0:e.length)?(d(),s("span",k)):(d(),x(N,{key:0,class:"pt-[40px]"},{default:f(()=>[u("span",V,h(t.$t("emptyNoData")),1)]),_:1}))]}),default:f(()=>[m(L,{label:b(U)("tradeTime"),prop:"fundingTime"},{default:f(({row:e})=>[T(h(b(o)(+e.fundingTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),m(L,{label:b(U)("markets1"),prop:"contractId"},{default:f(({row:e})=>[T(h(b(K)[e.contractId]),1)]),_:1},8,["label"]),m(L,{width:100,align:"right",label:b(U)("direction"),prop:"direction"},{default:f(({row:e})=>[u("span",{class:w(e.fundingPositionSize>0?"color-[--up-color]":"color-[--down-color]")},h(e.fundingPositionSize>0?b(U)("long"):b(U)("short")),3)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("contractSize"),prop:"contractSize"},{default:f(({row:e})=>{var a,l;return[T(h(("formatNumber"in t?t.formatNumber:b(y))(new(b(C))(e.fundingPositionSize).abs().toString()))+h(null==(l=null==(a=b(K)[e.contractId])?void 0:a.replace)?void 0:l.call(a,"USD","")),1)]}),_:1},8,["label"]),m(L,{align:"right",label:b(U)("fundingFee"),prop:"deltaFundingFee"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(new(b(C))(e.deltaFundingFee).abs().toString()))+"USD ",1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("fundingRate"),prop:"fundingRate"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(100*Math.abs(e.fundingRate)))+"% ",1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("oraclePrice"),prop:"fundingOraclePrice"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(e.fundingOraclePrice,{limit:20,decimals:2})),1)]),_:1},8,["label"]),m(L,{align:"right",label:b(U)("indexPrice"),prop:"fundingIndexPrice"},{default:f(({row:e})=>[T(h(("formatNumber"in t?t.formatNumber:b(y))(e.fundingIndexPrice,{limit:20,decimals:2})),1)]),_:1},8,["label"])]),_:1},8,["data"]),u("div",F,[b(R).loading&&b(q)?(d(),s("span",M,h(b(U)("loading")),1)):I("",!0)])],8,P)),[[Q,G]])],64)}}});export{O as default};
