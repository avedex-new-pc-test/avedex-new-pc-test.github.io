import{n as e,cD as l,bs as t,aw as a,bt as n,bu as o,bv as s,bw as i,a2 as u,a7 as r,c as d,o as c,M as p,S as v,b as m,H as x,aa as b,t as g,aQ as f,R as y,J as h,E as w,aM as k,w as S,a as B,a5 as T,a6 as V,al as $,K as _,F,bx as q,aN as A,by as C,d as L,bz as N,bA as M,bB as j,au as I,ac as E,a8 as Q,ax as G,bC as P,ca as R,T as U,L as D,am as z,an as H,ao as O,aV as W,cB as K,cM as J,dn as Y,dp as X,dq as Z,dr as ee,ds as le,dt as te,D as ae,du as ne,dv as oe,dw as se}from"./Ck65DhTU.js";import{S as ie}from"./D-tFlNOh.js";import{u as ue}from"./CO5_ekb3.js";import{r as re,u as de}from"./CSZyNKXU.js";const ce={class:"items-center inline-flex"},pe={key:0,class:"w-14px h-14px bg-[--secondary-text] rounded-full flex items-center justify-center mr-5px"},ve={key:1,class:"w-14px h-14px bg-[--secondary-text] rounded-full flex items-center justify-center mr-5px"},me={key:2,class:"mr-5px color-[--secondary-text] text-12px"},xe=["src"],be={key:3,class:"ml-20px flex justify-end items-center text-12px"},ge={class:"color-[--secondary-text] mr-5px"},fe={class:"flex items-center justify-between p-1px rounded-4px text-12px h-28px bg-[--main-input-button-bg] px-2px py-2px"},ye=["id","onClick","onMouseenter"],he={class:"text-14px mt-4px mb-4px flex-start"},we={class:"mr-4px color-[--third-text] text-14px"},ke={key:0},Se={key:1},Be={key:0,class:"text-14px mt-4px mb-4px flex-start"},Te={class:"mr-4px color-[--third-text] text-14px"},Ve={key:1,class:"text-14px mt-4px mb-4px flex-start"},$e={class:"mr-4px color-[--third-text] text-14px whitespace-nowrap block"},_e={class:"whitespace-nowrap"},Fe={class:"text-14px mt-4px mb-4px flex-start"},qe={class:"mr-4px color-[--third-text] text-14px whitespace-nowrap"},Ae={class:"text-14px mt-4px mb-4px flex-start"},Ce={class:"mr-4px color-[--third-text] text-14px"},Le=e({__name:"quickSwapSet",props:{chain:{},quickBuyValue:{default:"0.01"},showQuickAmount:{type:Boolean},settingsButtonVisible:{type:Boolean,default:!0},quickTextVisible:{type:Boolean,default:!0}},emits:["update:quickBuyValue"],setup(e,{emit:G}){l();const P=t(),R=a(),U=n(),D=o(),z=s(),H=i(),O=G,W=e,K=u(),J=I(0),Y=F(!1),X=F("s1"),Z=F({}),ee=F(null),le=w(()=>H.provider&&H.address&&!P.evmAddress),te=w(()=>W.chain&&P.isSupportChains.includes(W.chain)&&!le.value),ae=w(()=>W.settingsButtonVisible&&!le.value),ne=w(()=>{var e,l,t;const a=W.chain;if(!P.isSupportChains.includes(a))return"";const n=null==(t=null==(l=null==(e=D.botSettings)?void 0:e[a])?void 0:l.buy)?void 0:t[X.value],o=null==n?void 0:n.mev,{gasTip1List:s,gasTip2List:i}=N(U.gasTip,a),u=o?s:i,r=o?0:1,d=null==n?void 0:n.gas[r];return(null==d?void 0:d.customFee)||(null==u?void 0:u[null==d?void 0:d.level])}),oe=w({get:()=>W.quickBuyValue,set(e){O("update:quickBuyValue",e)}});function se(e){e&&(null==e?void 0:e.id)&&(Z.value[null==e?void 0:e.id]=e)}function ue(e){X.value=e,ee.value=Z.value[e]||null,Y.value=!0,function(){var e;const l=W.chain;if(!C(l))return;null==(e=j(l))||e.getFeeData().then(e=>{e&&(J.value=new M(e.gasPrice||0).toNumber())})}()}function re(){var e,l,t,a,n,o,s,i,u;const r=W.chain;if(C(r)&&(null==(e=null==P?void 0:P.isSupportChains)?void 0:e.includes(r))){const e=null==(a=null==(t=null==(l=D.botSettings)?void 0:l[r])?void 0:t.buy)?void 0:a[X.value],d=null==e?void 0:e.mev,c=(null==(o=null==(n=U.mainTokensPrice)?void 0:n.find(e=>{var l;return e.chain===r&&e.token===(null==(l=E(r))?void 0:l.wmain_wrapper)}))?void 0:o.current_price_usd)||z.swap.native.price||0,{gasTip1List:p,gasTip2List:v}=N(U.gasTip,r),m=d?p:v,x=d?null==e?void 0:e.gas[0]:null==e?void 0:e.gas[1],b=(null==x?void 0:x.customFee)||(null==m?void 0:m[null==x?void 0:x.level])||"3",g=(null==(u=null==(i=null==(s=U.gasTip)?void 0:s.find)?void 0:i.call(s,e=>e.chain===r&&e.mev===!!d))?void 0:u.gasLimit)||2e5;return Q(new M(J.value).plus(new M(b).times(String(10**9))).times(g).times(c).div(String(10**18)).toFixed(),2)}return 0}return(l,t)=>{var a;const n=b,o=f,s=A,i=r("tooltip");return c(),d("div",ce,[e.quickTextVisible?(c(),d("span",pe,[m(n,{class:"color-[--main-bg] text-10px",name:"mynaui:lightning-solid"})])):p((c(),d("span",ve,[m(n,{class:"color-[--main-bg] text-10px",name:"mynaui:lightning-solid"})])),[[i,l.$t("quick")]]),e.quickTextVisible?(c(),d("span",me,g(l.$t("quick")),1)):v("",!0),m(o,{modelValue:h(oe),"onUpdate:modelValue":t[0]||(t[0]=e=>k(oe)?oe.value=e:null),modelModifiers:{trim:!0},style:{"--el-input-text-color":"var(--main-text)","border-radius":"4px",width:"88px",height:"28px"},placeholder:"0",clearable:"",type:"text",onInput:t[1]||(t[1]=e=>{oe.value=e.replace(/\-|[^\d.]/g,"")}),onBlur:t[2]||(t[2]=e=>function(e){var l,t,a;const n=e,o=(null==(a=null==(t=null==(l=new M(n||0))?void 0:l.toFixed)?void 0:t.call(l).match(new RegExp("[0-9]*(\\.[0-9]{0,4})?")))?void 0:a[0])||"";String(n)!==String(o)&&(""===n?oe.value="":0===Number(o)?oe.value="0":oe.value=o)}(h(oe))),onKeydown:t[3]||(t[3]=y(e=>{var l;return null==(l=null==e?void 0:e.target)?void 0:l.blur()},["enter"]))},{prefix:S(()=>[e.chain?(c(),d("img",{key:0,class:"rounded-full w-14px h-14px mr-4px!",src:`${h(R).token_logo_url}chain/${e.chain}.png`,alt:"",onerror:"this.src='/icon-default.png'",srcset:""},null,8,xe)):v("",!0)]),_:1},8,["modelValue"]),h(te)&&h(ae)?(c(),d("div",be,[B("span",ge,g(l.$t("default")),1),B("div",fe,[(c(!0),d(T,null,V("BotSettingsArr"in l?l.BotSettingsArr:h(q),l=>{var a,n,o;return c(),d("button",{id:l.value,key:l.value,ref_for:!0,ref:se,class:_(["cursor-pointer border-none font-400 rounded-4px min-w-36px py-5px px-10px text-center",""+(l.value===(null==(o=null==(n=null==(a=h(D).botSettings)?void 0:a[e.chain])?void 0:n.buy)?void 0:o.selected)?"color-[--main-text] bg-[--tab-active-bg]":"color-[--secondary-text] bg-transparent")]),type:"button",onClick:$(t=>h(D).botSettings[e.chain].buy.selected=l.value,["stop"]),onMouseenter:e=>ue(l.value),onMouseleave:t[4]||(t[4]=e=>Y.value=!1)},g(l.label),43,ye)}),128))])])):v("",!0),h(te)?(c(),x(ie,{key:4,class:"ml-12px",chain:e.chain,setting:null==(a=h(D))?void 0:a.botSettings[e.chain],showQuickAmount:e.showQuickAmount},null,8,["chain","setting","showQuickAmount"])):v("",!0),m(s,{visible:h(Y),"onUpdate:visible":t[5]||(t[5]=e=>k(Y)?Y.value=e:null),"popper-class":"new-popover","virtual-ref":h(ee),"virtual-triggering":"",trigger:"contextmenu",placement:"bottom","popper-style":"min-width: auto; width: auto;",persistent:!1},{default:S(()=>{var t,a,o,s,u,r,x,b,f,y,w,k,S;return[B("ul",null,[B("li",he,[p(m(n,{name:"custom:slippage",class:"text-14px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("slippage")]]),B("span",we,g(l.$t("slippage")),1),"auto"!==(null==(s=null==(o=null==(a=null==(t=h(D).botSettings)?void 0:t[e.chain])?void 0:a.buy)?void 0:o[h(X)])?void 0:s.slippage)?(c(),d("span",ke,g(null==(b=null==(x=null==(r=null==(u=h(D).botSettings)?void 0:u[e.chain||""])?void 0:r.buy)?void 0:x[h(X)])?void 0:b.slippage)+"%",1)):(c(),d("span",Se,g(l.$t("auto")),1))]),h(C)(e.chain||"")?(c(),d("li",Be,[p(m(n,{name:"custom:gas",class:"text-14px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("estimatedGas")]]),B("span",Te,g(l.$t("estimatedGas")),1),L(" $"+g(re()),1)])):v("",!0),"solana"===e.chain?(c(),d("li",Ve,[p(m(n,{name:"custom:gas",class:"text-14px color-[--third-text] mr-6px cursor-pointer ml-0"},null,512),[[i,l.$t("priorityFee")]]),B("span",$e,g(l.$t("priorityFee")),1),B("span",_e,g(h(ne))+" SOL",1)])):v("",!0),B("li",Fe,[p(m(n,{name:`custom:half-${h(K).mode}`,class:"text-18px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,8,["name"]),[[i,l.$t("autoSellHalf")]]),B("span",qe,g(l.$t("autoSellHalf")),1),L(" "+g((null==(f=h(D).autoSellConfigs)?void 0:f.autoSell)?l.$t("on"):l.$t("off")),1)]),B("li",Ae,[p(m(n,{name:"custom:mev",class:"text-16px color-[--third-text] ml-0 mr-6px cursor-pointer"},null,512),[[i,l.$t("mev")]]),B("span",Ce,g(l.$t("mev")),1),L(" "+g((null==(S=null==(k=null==(w=null==(y=h(D).botSettings)?void 0:y[e.chain])?void 0:w.buy)?void 0:k[h(X)])?void 0:S.mev)?l.$t("on"):l.$t("off")),1)])])]}),_:1},8,["visible","virtual-ref"])])}}}),Ne={key:1,class:"ml-5px"},Me={class:"text-20px"},je={class:"min-h-60px py-10px"},Ie={class:"text-16px"},Ee={class:"flex mt-10px"},Qe=e({__name:"quickSwapButton",props:{quickBuyValue:{},row:{},appendTo:{default:"#__nuxt"},buttonBg:{default:"rgba(18, 184, 134, 0.15)"},mainNameVisible:{type:Boolean},classNames:{default:""},styles:{default:""}},emits:["submitSwap"],setup(e,{emit:l}){const{t:a}=G(),u=e,r=t(),p=I(!1),f=I(!1),y=I(""),w=P("noReminderQuickBuy",!1),{walletSwap:V,loadingWalletSwap:F}=ue(),q=i(),A=l;function C(e){var l;if(e.stopPropagation(),A("submitSwap"),!J())return;if(p.value)return;if(new M(u.quickBuyValue||0).lte(0))return void Y({title:"Error",type:"error",message:a("amountMustG0")});const{row:t}=u;y.value=a("quickBuyMsg",{a:u.quickBuyValue,m:(null==(l=E(u.row.chain))?void 0:l.main_name)||"",s:t.symbol||(t.target_token==t.token0_address?t.token0_symbol:t.token1_symbol)}),w.value?ie():f.value=!0}const j=I(),Q=o();async function ie(){var e;if(f.value=!1,q.provider&&q.address&&!r.evmAddress)return void async function(){const e=new M(u.quickBuyValue||0).toFixed();V(e,u.row)}();const{chain:l}=u.row;p.value=!0,await async function(e){var l,t,a,n;const o=r.getWalletAddress(e);if(!o)return;const s=null==(l=r.userInfo.addresses.find(l=>l.chain===e))?void 0:l.balance;let i={chain:e,token:X(e),address:X(e),decimals:null==(t=E(e))?void 0:t.decimals,symbol:null==(a=E(e))?void 0:a.main_name};if(s)return void(j.value={...i,balance:s});const u=await ne({chain:e,tokens:[X(e)],walletAddress:o});i=(null==u?void 0:u[0])||{},j.value={...i,symbol:null==(n=E(e))?void 0:n.main_name,chain:e,address:i.token||i.address,decimals:i.decimals||i.decimal}}(l);const t=j.value,o=null==(e=new M(u.quickBuyValue||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${(null==t?void 0:t.decimals)||18}})?`)))?void 0:e[0];return(Number(o)||0)<=0?(Y({title:"Error",type:"error",message:a("amountTooSmall")}),void(p.value=!1)):new M(o||0).gt((null==t?void 0:t.balance)||0)?(Y({title:"Error",type:"error",message:a("insufficientBalance")}),void(p.value=!1)):void async function(e){var l,t,o,s,i;const{chain:d}=u.row,c="solana"===d,{botSettings:v}=Q,m=null==(t=null==(l=null==v?void 0:v[d])?void 0:l.buy)?void 0:t.selected,x=null==(s=null==(o=null==v?void 0:v[d])?void 0:o.buy)?void 0:s[m];if(c&&(null==x?void 0:x.mev)&&!(await r.getBundleAvailable()))return void(p.value=!1);const{gasTip1List:b,gasTip2List:g}=N(n().gasTip,"solana"),f=(null==x?void 0:x.mev)?b:g,y=(null==x?void 0:x.mev)?null==x?void 0:x.gas[0]:null==(i=null==x?void 0:x.gas)?void 0:i[1];let h={};if(c){let e=(null==y?void 0:y.customFee)||(null==f?void 0:f[null==y?void 0:y.level])||"0.002";(null==x?void 0:x.mev)&&new M(e).lt("0.002")&&(e="0.002"),h.priorityFee=new M(e).times(10**9).toFixed(0)}else{const e=0===Number(null==y?void 0:y.customFee)?"0":(null==y?void 0:y.customFee)||(null==f?void 0:f[null==y?void 0:y.level])||"3";h.gasTip=Number(new M(e).times(10**9).toFixed(0)),h.contractType=0,h.chain=d}const w=X(d),k=(null==x?void 0:x.slippage)||"9",S=r.getWalletAddress(d);if(!S)return;const B=Date.now().toString();h={...h,swapList:[{batchId:B,creatorAddress:S,inAmount:new M(e||0).times(10**j.value.decimals||0).toFixed(0)}],inTokenAddress:w,outTokenAddress:u.row.token||u.row.target_token,swapType:1,isPrivate:(null==x?void 0:x.mev)||!1,slippage:"auto"!==k?Number(new M(k).times(100).toFixed(0)):900,autoSell:Q.autoSellConfig_autoSell||!1,autoSellConfig:null==Q?void 0:Q.selectedAutoSellConfig,autoGas:(null==y?void 0:y.customFee)?0:((null==y?void 0:y.level)||0)+1,autoSellGas:(null==y?void 0:y.customFee)?0:((null==y?void 0:y.level)||0)+1,autoSellPriorityFee:c?h.priorityFee:h.gasTip};let T=Z;c?T=oe:"ton"===d&&(T=se);T(h).then(e=>function(e,l){var t;if(e){const n=(null==(t=null==u?void 0:u.row)?void 0:t.chain)||"",o=(null==e?void 0:e[0])||{};if(le(o))return ee(te(o)),void(p.value=!1);let s=setTimeout(()=>{ce.placeOrderUpdate++,p.value=!1},500);const i={solana:"/botapi/swap/createSolTx",ton:"/botapi/swap/createSwapTonTx"};re({txInfo:o,chain:n,destination:(null==i?void 0:i[n])||"/botapi/swap/createSwapEvmTx",type:10});const r={[null==o?void 0:o.batchId]:null==o?void 0:o.id},d=ae(()=>pe.wsResult.tgbot,e=>{var t,n,o,i,u;const c=e.batchId;if(c===l){if(s&&(clearTimeout(s),s=null),ce.placeOrderSuccess++,null==(n=null==(t=null==e?void 0:e.txList)?void 0:t[0])?void 0:n.success){Y({type:"success",message:a("tradeSuccess")});const l=null==(o=null==e?void 0:e.txList)?void 0:o[0];de({...l,chain:null==e?void 0:e.chain},(null==r?void 0:r[c])||"")}else ee((null==(u=null==(i=null==e?void 0:e.txList)?void 0:i[0])?void 0:u.failMessage)||"swap error");d(),p.value=!1}})}}(e,B)).catch(e=>{ee(e||"swap error"),p.value=!1})}(o)}const ce=s(),pe=R();return(l,t)=>{const a=b,n=U,o=W,s=K;return c(),d(T,null,[m(n,{disabled:!Number(e.quickBuyValue),loading:h(p)||h(F),color:e.buttonBg,class:_(["flex items-center [&&]:px-12px",e.classNames]),style:D([{"--el-button-hover-bg-color":"#12B886","--el-button-hover-text-color":"#FFF","--el-color-black":"#12B886","--el-button-border-color":"transparent","--el-button-hover-border-color":"transparent","--el-button-disabled-text-color":"#12B886","--el-button-disabled-border-color":"transparent","--el-button-disabled-bg-color":"#12B8861A"},e.styles]),onClick:C},{default:S(()=>[z(l.$slots,"default",H(O({loading:h(p)||h(F)})),()=>{var t;return[h(p)||h(F)?v("",!0):(c(),x(a,{key:0,class:"mr-4px",name:"mynaui:lightning-solid"})),L(" "+g(e.quickBuyValue||0)+" ",1),e.mainNameVisible?(c(),d("span",Ne,g((null==(t=("getChainInfo"in l?l.getChainInfo:h(E))(e.row.chain))?void 0:t.main_name)||""),1)):v("",!0)]})]),_:3},8,["disabled","loading","color","class","style"]),h(f)?(c(),x(s,{key:0,modelValue:h(f),"onUpdate:modelValue":t[1]||(t[1]=e=>k(f)?f.value=e:null),title:l.$t("buy"),width:"400px","append-to":e.appendTo,"destroy-on-close":""},{header:S(()=>[B("span",Me,g(l.$t("buy")),1)]),footer:S(()=>[m(n,{type:"primary",class:"w-full",size:"large",onClick:$(ie,["stop"])},{default:S(()=>[L(g(l.$t("confirm1")),1)]),_:1})]),default:S(()=>[B("div",je,[B("div",Ie,g(h(y)),1),B("div",Ee,[m(o,{modelValue:h(w),"onUpdate:modelValue":t[0]||(t[0]=e=>k(w)?w.value=e:null),class:"[&&]:[--el-checkbox-text-color:--d-999-l-666]",label:l.$t("noAlert"),size:"large"},null,8,["modelValue","label"])])])]),_:1},8,["modelValue","title","append-to"])):v("",!0)],64)}}});export{Le as _,Qe as a};
